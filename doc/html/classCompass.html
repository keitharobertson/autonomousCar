<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Real-Time Embedded Autonomous Car: Compass Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Real-Time Embedded Autonomous Car
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classCompass-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Compass Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>compass data collection and analysis  
 <a href="classCompass.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Compass_8h_source.html">Compass.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Compass:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classCompass.png" usemap="#Compass_map" alt=""/>
  <map id="Compass_map" name="Compass_map">
<area href="classSensor.html" title="Sensor class manages sensor tasks." alt="Sensor" shape="rect" coords="0,56,72,80"/>
<area href="classSubsystem.html" title="The Subsystem class defines the basic properties shared by all subsystems." alt="Subsystem" shape="rect" coords="0,0,72,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass_1_1Vector3d.html">Vector3d</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4210309aac39913ac3b20a0fef51df0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#ab4210309aac39913ac3b20a0fef51df0">Compass</a> (<a class="el" href="struct__ADC__DATA.html">ADC_DATA</a> *adc_data_ptr)</td></tr>
<tr class="memdesc:ab4210309aac39913ac3b20a0fef51df0"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a> default constructor.  <a href="#ab4210309aac39913ac3b20a0fef51df0"></a><br/></td></tr>
<tr class="memitem:aa4132c05a4e20e95633c72776385bc42"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#aa4132c05a4e20e95633c72776385bc42">data_grab</a> ()</td></tr>
<tr class="memdesc:aa4132c05a4e20e95633c72776385bc42"><td class="mdescLeft">&#160;</td><td class="mdescRight">grabs data from compass  <a href="#aa4132c05a4e20e95633c72776385bc42"></a><br/></td></tr>
<tr class="memitem:a5cc2b71700af542b5aafadea4820a476"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a5cc2b71700af542b5aafadea4820a476">init_sensor</a> ()</td></tr>
<tr class="memdesc:a5cc2b71700af542b5aafadea4820a476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the <a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a>.  <a href="#a5cc2b71700af542b5aafadea4820a476"></a><br/></td></tr>
<tr class="memitem:ae8d7f3417a27b1d18487b96ca07dd32b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#ae8d7f3417a27b1d18487b96ca07dd32b">collector</a> ()</td></tr>
<tr class="memdesc:ae8d7f3417a27b1d18487b96ca07dd32b"><td class="mdescLeft">&#160;</td><td class="mdescRight">collects data from the <a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a>  <a href="#ae8d7f3417a27b1d18487b96ca07dd32b"></a><br/></td></tr>
<tr class="memitem:a4dd6402d0ece9203c6b92670265b4c8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a4dd6402d0ece9203c6b92670265b4c8d">analysis</a> ()</td></tr>
<tr class="memdesc:a4dd6402d0ece9203c6b92670265b4c8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the analysis of the data collected from the compass and commands the actuators.  <a href="#a4dd6402d0ece9203c6b92670265b4c8d"></a><br/></td></tr>
<tr class="memitem:a1fb0f64b335e8f1d4f27dc2067312b4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a1fb0f64b335e8f1d4f27dc2067312b4a">handle_message</a> (<a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> *message)</td></tr>
<tr class="memdesc:a1fb0f64b335e8f1d4f27dc2067312b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles messages sent to the compass subsystem.  <a href="#a1fb0f64b335e8f1d4f27dc2067312b4a"></a><br/></td></tr>
<tr class="memitem:ab55d084e2d643df0a1970f5868d0c5a8"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#ab55d084e2d643df0a1970f5868d0c5a8">read_data</a> (int command)</td></tr>
<tr class="memdesc:ab55d084e2d643df0a1970f5868d0c5a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads in data from message to the compass.  <a href="#ab55d084e2d643df0a1970f5868d0c5a8"></a><br/></td></tr>
<tr class="inherit_header pub_methods_classSensor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSensor')"><img src="closed.png" alt="-"/>&nbsp;Public Member Functions inherited from <a class="el" href="classSensor.html">Sensor</a></td></tr>
<tr class="memitem:a342d6d11ef572c8cba92cb76fb1a294b inherit pub_methods_classSensor"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#a342d6d11ef572c8cba92cb76fb1a294b">Sensor</a> ()</td></tr>
<tr class="memdesc:a342d6d11ef572c8cba92cb76fb1a294b inherit pub_methods_classSensor"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSensor.html" title="Sensor class manages sensor tasks.">Sensor</a> default constructor.  <a href="#a342d6d11ef572c8cba92cb76fb1a294b"></a><br/></td></tr>
<tr class="memitem:aee8c70e7ef05ce65e7ee33686b5d7db2 inherit pub_methods_classSensor"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#aee8c70e7ef05ce65e7ee33686b5d7db2">~Sensor</a> ()</td></tr>
<tr class="memdesc:aee8c70e7ef05ce65e7ee33686b5d7db2 inherit pub_methods_classSensor"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSensor.html" title="Sensor class manages sensor tasks.">Sensor</a> destructor.  <a href="#aee8c70e7ef05ce65e7ee33686b5d7db2"></a><br/></td></tr>
<tr class="memitem:a84bc35cfba92eb579bc311b3c8b2980d inherit pub_methods_classSensor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#a84bc35cfba92eb579bc311b3c8b2980d">init</a> ()</td></tr>
<tr class="memdesc:a84bc35cfba92eb579bc311b3c8b2980d inherit pub_methods_classSensor"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the sensor  <a href="#a84bc35cfba92eb579bc311b3c8b2980d"></a><br/></td></tr>
<tr class="memitem:a2f08975182e98e644efb226435124047 inherit pub_methods_classSensor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#a2f08975182e98e644efb226435124047">shutdown</a> ()</td></tr>
<tr class="memdesc:a2f08975182e98e644efb226435124047 inherit pub_methods_classSensor"><td class="mdescLeft">&#160;</td><td class="mdescRight">shuts down the sensor  <a href="#a2f08975182e98e644efb226435124047"></a><br/></td></tr>
<tr class="inherit_header pub_methods_classSubsystem"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSubsystem')"><img src="closed.png" alt="-"/>&nbsp;Public Member Functions inherited from <a class="el" href="classSubsystem.html">Subsystem</a></td></tr>
<tr class="memitem:abdec44abe9ddba76f65abb02f8f62992 inherit pub_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#abdec44abe9ddba76f65abb02f8f62992">Subsystem</a> ()</td></tr>
<tr class="memdesc:abdec44abe9ddba76f65abb02f8f62992 inherit pub_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSubsystem.html" title="The Subsystem class defines the basic properties shared by all subsystems.">Subsystem</a> default constructor.  <a href="#abdec44abe9ddba76f65abb02f8f62992"></a><br/></td></tr>
<tr class="memitem:af6026d0c678986cf1626251bf38916fa inherit pub_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#af6026d0c678986cf1626251bf38916fa">~Subsystem</a> ()</td></tr>
<tr class="memdesc:af6026d0c678986cf1626251bf38916fa inherit pub_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSubsystem.html" title="The Subsystem class defines the basic properties shared by all subsystems.">Subsystem</a> destructor.  <a href="#af6026d0c678986cf1626251bf38916fa"></a><br/></td></tr>
<tr class="memitem:a2c33b82253ec4588067349e33247f504 inherit pub_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#a2c33b82253ec4588067349e33247f504">send_sys_message</a> (<a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> *message)</td></tr>
<tr class="memdesc:a2c33b82253ec4588067349e33247f504 inherit pub_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight">send message to system  <a href="#a2c33b82253ec4588067349e33247f504"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a15cd7eda15b824c8d5821a46667b861c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a15cd7eda15b824c8d5821a46667b861c">hard_right</a></td></tr>
<tr class="memitem:a9e9ff6610d60e6fd915984a3f3e40e13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a9e9ff6610d60e6fd915984a3f3e40e13">slight_right</a></td></tr>
<tr class="memitem:aa11186aa6caf9dced42940552bf24da2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#aa11186aa6caf9dced42940552bf24da2">straight</a></td></tr>
<tr class="memitem:a5cbc2cebdd91222c5ccf5bd28aa35ced"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a5cbc2cebdd91222c5ccf5bd28aa35ced">hard_left</a></td></tr>
<tr class="memitem:a9e0a282c1253451fd7967646074102ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a9e0a282c1253451fd7967646074102ee">slight_left</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a72a3d0e853685bdbc6758120ebd10800"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct__ADC__DATA.html">ADC_DATA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a72a3d0e853685bdbc6758120ebd10800">adc_data</a></td></tr>
<tr class="memitem:aed40464cb0c9203d87ab8a9127cc9080"><td class="memItemLeft" align="right" valign="top">struct spi_ioc_transfer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#aed40464cb0c9203d87ab8a9127cc9080">msg</a> [1]</td></tr>
<tr class="memitem:ac888a4dacdc477e53c99fe8e110966ae"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#ac888a4dacdc477e53c99fe8e110966ae">desired_heading</a></td></tr>
<tr class="memitem:af0f87a131e2c9833f7d52bed1a39bf75"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#af0f87a131e2c9833f7d52bed1a39bf75">meas_heading</a></td></tr>
<tr class="memitem:ace6e13b91461366609f093fef09188d9"><td class="memItemLeft" align="right" valign="top">sem_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#ace6e13b91461366609f093fef09188d9">collect_analysis_sync</a></td></tr>
<tr class="memitem:a44b0e4223918e3b139e54d54a0e3daad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a44b0e4223918e3b139e54d54a0e3daad">compass_fd</a></td></tr>
<tr class="memitem:a2a55ab6b29ea9ddca507a948cb30d42b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a2a55ab6b29ea9ddca507a948cb30d42b">accel_fd</a></td></tr>
<tr class="memitem:a6ff33d93efe79539c75dbee45efdc97c"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a6ff33d93efe79539c75dbee45efdc97c">compass_filepath</a> [40]</td></tr>
<tr class="memitem:a69f89e1a0d7c769e02cd3704904e40fd"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a69f89e1a0d7c769e02cd3704904e40fd">accel_filepath</a> [40]</td></tr>
<tr class="memitem:a90f2dea7249c85f22c5bc45ed9d86b57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompass.html#a90f2dea7249c85f22c5bc45ed9d86b57">min_priority</a></td></tr>
<tr class="memitem:a08a0c0243b0c0dbfef446b7cdc6171a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08a0c0243b0c0dbfef446b7cdc6171a5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>data_grab_count</b></td></tr>
<tr class="memitem:ae19b46ed0c752445d27175c2205e2d6e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae19b46ed0c752445d27175c2205e2d6e"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>x</b></td></tr>
<tr class="memitem:a92ae0ec7df5da4f682653edc59a3902e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a92ae0ec7df5da4f682653edc59a3902e"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>y</b></td></tr>
<tr class="memitem:ad69ac341e3d3e3c956658bb847f271d5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad69ac341e3d3e3c956658bb847f271d5"></a>
int16_t&#160;</td><td class="memItemRight" valign="bottom"><b>z</b></td></tr>
<tr class="memitem:a7b2d3072f705f74c4b9a34616cb10316"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7b2d3072f705f74c4b9a34616cb10316"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>subsys_priorities</b> [<a class="el" href="group__subsys__nums.html#gad914679f013f117ec7470f75fee6149a">NUM_SUBSYSTEMS</a>+1]</td></tr>
<tr class="memitem:a81f32d364178d84fe50f0cc04525b343"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a81f32d364178d84fe50f0cc04525b343"></a>
<a class="el" href="classCompass_1_1Vector3d.html">Vector3d</a>&#160;</td><td class="memItemRight" valign="bottom"><b>adxlA</b> [COMPASS_AVERAGEA]</td></tr>
<tr class="memitem:a92846ee84028d3c778f0ff86ec665aa1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a92846ee84028d3c778f0ff86ec665aa1"></a>
<a class="el" href="classCompass_1_1Vector3d.html">Vector3d</a>&#160;</td><td class="memItemRight" valign="bottom"><b>magnA</b> [COMPASS_AVERAGE]</td></tr>
<tr class="memitem:ad61bcefd1ac82df3cad26dc9dc09d3a8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad61bcefd1ac82df3cad26dc9dc09d3a8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>compass_avg</b></td></tr>
<tr class="memitem:a58f9feaf883ab8cdad53f26fbe202331"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a58f9feaf883ab8cdad53f26fbe202331"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>compass_avgA</b></td></tr>
<tr class="inherit_header pro_attribs_classSensor"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSensor')"><img src="closed.png" alt="-"/>&nbsp;Protected Attributes inherited from <a class="el" href="classSensor.html">Sensor</a></td></tr>
<tr class="memitem:a881761631861338b335680ab1e618277 inherit pro_attribs_classSensor"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#a881761631861338b335680ab1e618277">tCollector</a></td></tr>
<tr class="memitem:afce21e3a689654c7d165f2a0e01ab86c inherit pro_attribs_classSensor"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSensor.html#afce21e3a689654c7d165f2a0e01ab86c">tAnalysis</a></td></tr>
<tr class="inherit_header pro_attribs_classSubsystem"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSubsystem')"><img src="closed.png" alt="-"/>&nbsp;Protected Attributes inherited from <a class="el" href="classSubsystem.html">Subsystem</a></td></tr>
<tr class="memitem:abbb7a2f8cb57fa70eaf65c1b7c353e08 inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">struct mq_attr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#abbb7a2f8cb57fa70eaf65c1b7c353e08">attr</a></td></tr>
<tr class="memitem:a3ef2ff7ded6b1623fae096828d549369 inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">mqd_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#a3ef2ff7ded6b1623fae096828d549369">sys_mq</a></td></tr>
<tr class="memitem:a71c9d55e3baa41c75bbc54e9e4407bdd inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#a71c9d55e3baa41c75bbc54e9e4407bdd">prio</a></td></tr>
<tr class="memitem:a32fe49f94c0098b8cdb1983c162c0c73 inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">struct mq_attr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#a32fe49f94c0098b8cdb1983c162c0c73">timing_attr</a></td></tr>
<tr class="memitem:ab9d87a0c93b2cc65b0a053c325422c1c inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">mqd_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#ab9d87a0c93b2cc65b0a053c325422c1c">timing_mq</a></td></tr>
<tr class="memitem:aaf8fd18a5c37ec1510869a23ec0feb5f inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#aaf8fd18a5c37ec1510869a23ec0feb5f">timing_prio</a></td></tr>
<tr class="memitem:ae9c30b7c1ebe18eee34d1dca1530abb7 inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9c30b7c1ebe18eee34d1dca1530abb7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>num_timing_messages</b></td></tr>
<tr class="memitem:a0eccf033d19cca954aac5fb0d0cc51bf inherit pro_attribs_classSubsystem"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0eccf033d19cca954aac5fb0d0cc51bf"></a>
struct timespec&#160;</td><td class="memItemRight" valign="bottom"><b>timing_analysis</b> [TIMING_ANALYSIS_BUFFER_SIZE]</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classSubsystem"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classSubsystem')"><img src="closed.png" alt="-"/>&nbsp;Protected Member Functions inherited from <a class="el" href="classSubsystem.html">Subsystem</a></td></tr>
<tr class="memitem:aaa5c98618b06473ac3e88ad658f804ec inherit pro_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#aaa5c98618b06473ac3e88ad658f804ec">log_release_time</a> (struct timespec *release_time, int task_num)</td></tr>
<tr class="memdesc:aaa5c98618b06473ac3e88ad658f804ec inherit pro_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight">log the release time of a task  <a href="#aaa5c98618b06473ac3e88ad658f804ec"></a><br/></td></tr>
<tr class="memitem:ac3e8ba69ef5cf814f19b6a5ee25473ca inherit pro_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#ac3e8ba69ef5cf814f19b6a5ee25473ca">log_end_time</a> (struct timespec *end_time, int task_num)</td></tr>
<tr class="memdesc:ac3e8ba69ef5cf814f19b6a5ee25473ca inherit pro_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight">log the release time of a task  <a href="#ac3e8ba69ef5cf814f19b6a5ee25473ca"></a><br/></td></tr>
<tr class="memitem:a2cd6f9f05fecd33d8d362cd5c28f4e71 inherit pro_methods_classSubsystem"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSubsystem.html#a2cd6f9f05fecd33d8d362cd5c28f4e71">send_timing_message</a> (struct timespec *time, int task_num, bool is_start)</td></tr>
<tr class="memdesc:a2cd6f9f05fecd33d8d362cd5c28f4e71 inherit pro_methods_classSubsystem"><td class="mdescLeft">&#160;</td><td class="mdescRight">sends information to timing analysis  <a href="#a2cd6f9f05fecd33d8d362cd5c28f4e71"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>compass data collection and analysis </p>
<p>Collects data from the compass and analyzes the data. Sends system messages to control actuators </p>
</div><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab4210309aac39913ac3b20a0fef51df0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Compass::Compass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__ADC__DATA.html">ADC_DATA</a> *&#160;</td>
          <td class="paramname"><em>adc_data_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a> default constructor. </p>
<p>Sets subsystem parameters and sets up the collect/analysis task sync semaphore. </p>

</div>
</div>
<h2>Member Function Documentation</h2>
<a class="anchor" id="a4dd6402d0ece9203c6b92670265b4c8d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Compass::analysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the analysis of the data collected from the compass and commands the actuators. </p>
<p>The analysis function executes in the analysis thread and is synced with the collector task by the collect_analysis_sync semaphore. Depending on the difference between the current and desired headings, messages will be sent to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem using the system message queue to change course. </p>

<p>Implements <a class="el" href="classSensor.html#a595d8d9cd87dd3704fad2a313c709a7e">Sensor</a>.</p>

</div>
</div>
<a class="anchor" id="ae8d7f3417a27b1d18487b96ca07dd32b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Compass::collector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>collects data from the <a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a> </p>
<p>The collector function executes in the collector thread and executes indefinitely at a frequency of 20Hz. It calls the data_grab to do the actual communication with the hardware to provide a layer of abstraction between the software and specifics of the hardware. It can optionally average data prior to analysis if the system is expected to be under heavy load and the tasks are not schedulable with the typical release frequencies (averaging will have the effect that the analysis task will be released less frequently). </p>

<p>Implements <a class="el" href="classSensor.html#ae4ec41b880d44feb898da5c62c3203c9">Sensor</a>.</p>

</div>
</div>
<a class="anchor" id="aa4132c05a4e20e95633c72776385bc42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float Compass::data_grab </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>grabs data from compass </p>
<p>Gets data from the compass over I2C. Returns the current heading in degrees as a float. </p>

</div>
</div>
<a class="anchor" id="a1fb0f64b335e8f1d4f27dc2067312b4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Compass::handle_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> *&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles messages sent to the compass subsystem. </p>
<p>Performs tasks determined by the command part of the message. For example the command CPS_SET_HEADING is used to set the desired heading. Messages could be from command line interface or from another subsystem. </p>

<p>Implements <a class="el" href="classSensor.html#a45533b253f81f85d1b6fcea902a5692b">Sensor</a>.</p>

</div>
</div>
<a class="anchor" id="a5cc2b71700af542b5aafadea4820a476"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Compass::init_sensor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes the <a class="el" href="classCompass.html" title="compass data collection and analysis">Compass</a>. </p>
<p>Sets up the I2C driver and sets up the compass hardware to continuously spit out data at 20Hz. </p>

<p>Implements <a class="el" href="classSensor.html#a11b28f6bc91d6f69e734e13ab0e64f56">Sensor</a>.</p>

</div>
</div>
<a class="anchor" id="ab55d084e2d643df0a1970f5868d0c5a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * Compass::read_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>command</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads in data from message to the compass. </p>
<p>Will read data into appropriate data type and then cast to a void* and return. The type of data received depends on the message command. For example if trying to set the desired heading, a float is expected. This function will read the data in from standard in (using cin) into an appropriate datatype for the given command and will return the data to the system message handler for further processing. </p>

<p>Implements <a class="el" href="classSensor.html#acf4ff5c6c8f793ed47a8105b94ff7c3e">Sensor</a>.</p>

</div>
</div>
<h2>Member Data Documentation</h2>
<a class="anchor" id="a2a55ab6b29ea9ddca507a948cb30d42b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Compass::accel_fd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The i2c file descriptor for the compass </p>

</div>
</div>
<a class="anchor" id="a69f89e1a0d7c769e02cd3704904e40fd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char Compass::accel_filepath[40]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The filename for the compass device. (will be a device in /dev). </p>

</div>
</div>
<a class="anchor" id="a72a3d0e853685bdbc6758120ebd10800"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__ADC__DATA.html">ADC_DATA</a>* Compass::adc_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>returns the heading corrected for tilt store the adc data here for cross subsystem access </p>

</div>
</div>
<a class="anchor" id="ace6e13b91461366609f093fef09188d9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sem_t Compass::collect_analysis_sync</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The collect/analysis sync semaphore </p>

</div>
</div>
<a class="anchor" id="a44b0e4223918e3b139e54d54a0e3daad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Compass::compass_fd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The i2c file descriptor for the compass </p>

</div>
</div>
<a class="anchor" id="a6ff33d93efe79539c75dbee45efdc97c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char Compass::compass_filepath[40]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The filename for the compass device. (will be a device in /dev). </p>

</div>
</div>
<a class="anchor" id="ac888a4dacdc477e53c99fe8e110966ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float Compass::desired_heading</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The desired heading </p>

</div>
</div>
<a class="anchor" id="a5cbc2cebdd91222c5ccf5bd28aa35ced"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> Compass::hard_left</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A message that will, when sent, issue a command to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem to turn hard left </p>

</div>
</div>
<a class="anchor" id="a15cd7eda15b824c8d5821a46667b861c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> Compass::hard_right</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A message that will, when sent, issue a command to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem to turn hard right </p>

</div>
</div>
<a class="anchor" id="af0f87a131e2c9833f7d52bed1a39bf75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float Compass::meas_heading</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The last measured heading. Updated at 20Hz. </p>

</div>
</div>
<a class="anchor" id="a90f2dea7249c85f22c5bc45ed9d86b57"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Compass::min_priority</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the minimum subsystem priority that can change the compass heading </p>

</div>
</div>
<a class="anchor" id="aed40464cb0c9203d87ab8a9127cc9080"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct spi_ioc_transfer Compass::msg[1]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SPI request for sonar data from the <a class="el" href="classADC.html" title="compass data collection and analysis">ADC</a> </p>

</div>
</div>
<a class="anchor" id="a9e0a282c1253451fd7967646074102ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> Compass::slight_left</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A message that will, when sent, issue a command to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem to turn slightly left </p>

</div>
</div>
<a class="anchor" id="a9e9ff6610d60e6fd915984a3f3e40e13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> Compass::slight_right</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A message that will, when sent, issue a command to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem to turn slightly right </p>

</div>
</div>
<a class="anchor" id="aa11186aa6caf9dced42940552bf24da2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SUBSYS__COMMANDS_8h.html#ad814416fc1a8c675bea2687d96088a8f">MESSAGE</a> Compass::straight</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A message that will, when sent, issue a command to the <a class="el" href="classSteering.html" title="Steering control.">Steering</a> subsystem to go straight </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/keith/realtime/<a class="el" href="Compass_8h_source.html">Compass.h</a></li>
<li>/home/keith/realtime/Compass.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 5 2013 16:23:58 for Real-Time Embedded Autonomous Car by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
